
classes:
  # Services
  - system.docker.client
  # Docker services
  - system.docker.swarm.stack.docker
  - system.docker.swarm.stack.gerrit
  - system.docker.swarm.stack.jenkins
  - system.docker.swarm.stack.ldap

  # Jenkins
  - system.jenkins.master.config
  - system.jenkins.client
  - system.jenkins.client.credential.gerrit
  - system.jenkins.client.credential.salt
  # Jobs
  - system.jenkins.client.job.git-mirrors.downstream.pipelines
  - system.jenkins.client.job.deploy.openstack
  - system.jenkins.client.job.deploy.update
  # Security
  - system.jenkins.client.security.ldap
  - system.jenkins.client.security.matrix
  # Slaves
  - system.jenkins.client.node
  # OpenLDAP
  - system.openldap.client
  - system.openldap.client.people.admin

  # Gerrit
  - system.gerrit.client
  - system.gerrit.client.project.ci

  - system.docker.swarm.master

  - cluster.al.infra
  - cluster.al.cicd.control

parameters:
  _param:
    # Jenkins
    jenkins_slave_user: admin
    jenkins_client_user: admin
    jenkins_slave_password: ${_param:jenkins_admin_password}
    jenkins_client_password: ${_param:jenkins_admin_password}
    jenkins_admin_email: ${_param:admin_email}
    aptly_api_port: 8080
    aptly_public_port: 80
    jenkins_admin_public_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCYTLIs6KRTqXrPNOGSFROezK2paohuKNZe68HxJoeCe0uRe/RU3RyiSjoxBc2xt5yPZJL9ZXqXsNRucXCf77aqyDlAEA+gPaWImyrdzmiSZbd77MpwHMZpZiRh8cBA1C1MAPjhjRef4Gio/Ls7h+zgslq0KZNlag7ihTupT49/EXycHgP0RADe2vIqX+MRt8XcqTTl9n9rqbJR4OUI8krX9yUk4vztAVIzcrr9MpsuUiPl2B8TB4PfCp5FCJgSfNgIRbcjDR1u0Y71YeMZUKtZNpsaum0XmuXcPmnw2oEJbaRJTCE4oBoD1t51FuBew7GzXuMuf2MUyTXtjUxYGrXr
    jenkins_admin_private_key: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEpAIBAAKCAQEAmEyyLOikU6l6zzThkhUTnsytqWqIbijWXuvB8SaHgntLkXv0
      VN0coko6MQXNsbecj2SS/WV6l7DUbnFwn++2qsg5QBAPoD2liJsq3c5okmW3e+zK
      cBzGaWYkYfHAQNQtTAD44Y0Xn+BoqPy7O4fs4LJatCmTZWoO4oU7qU+PfxF8nB4D
      9EQA3tryKl/jEbfF3Kk05fZ/a6myUeDlCPJK1/clJOL87QFSM3K6/TKbLlIj5dgf
      EweD3wqeRQiYEnzYCEW3Iw0dbtGO9WHjGVCrWTabGrptF5rl3D5p8NqBCW2kSUwh
      OKAaA9bedRbgXsOxs17jLn9jFMk17Y1MWBq16wIDAQABAoIBACHiZn3xYKYwfd9d
      /5XV1KCvHzAjQKlpspA52dOCZAHW1rBOqMS80SMWaq3/gY05sb6BfOadzlGziP/t
      g0ZCOhzzITGsoR1gudST2UyyILf5o4IR49RfwpEupYeZFtIVouJXEQh1sLzkW8TF
      Pg73pe80H1QYL/APUbJ6PBTmW6HEdVai4LRIQs54dwxpHhd32Otv/tbp93sJqwGh
      nc9kVjn/5OwXsZOLjlOk4ae8L2eXcIXQzm1NMrdgcKbHWQ3wbb9wjc1awP9XmMT5
      Cd0b3t9YkR0GFjjOQM9vUuooFP6PxHPyBCqVlb1isiUG4igzY+md9ZbbAKSTIyFB
      MkH3ZMkCgYEAyjPUCEBAX74Wr3ml2e/fnWEK1fH/Izr33EwQ11cWH3GtndcxBrI0
      jPCiKN6ymKxDQDko9l4FY+mZ2hk7s6mAZqIq5o3xxWXlM3pP/TfGz/zTju7VzVk+
      f14cVWrT+Nukxyvz7MTyDbwi8w2UVHnWve3DYV7mtKR0f9LH43T74+cCgYEAwNHx
      nMTnm1JBXP44hpW9ZPHMA7XaR1USA1UScll1Hbd4F2CTZpdFUd9MJmDDaLY5GDfs
      e0+xYSNd+s4QI4pWCtUl6BfPQ0fa4tYAYP0gF+BbGopUQ+eBpUzHHFh3BIHDryM8
      SYKFHd9w7g9xbNETk2se1J0KBXEN+p9/PhkCXV0CgYEAj6u/zpUIqH7CU7BV3cKI
      2qQnNNkb9gZiMw+BL+DbAUCeofZTCXT5zeL09aE2uTA9IJb8ugEYR2OmQ8eGGiQn
      7cTwQp082ouKDcesqjlFdGcqUvb0x1HQDGPsMe0T7FD0heh/Cw7tBkFVe+l8KYHg
      yVb1amwp9NSdSm2URdPLXqUCgYEAoajjKw6jJ8Pk7TRu69drPNDEvW+gHCIkwgp3
      NsvttwZ1dxQPQPoesi/Gxn5mFsqAP9/TMudzzf868eYF/eYjkV13NImRydTanUfS
      dX6Dg8EkYLINSAk21wHyBb/duTeaeqHOD8uQE6WcJttnu1XnVbd/1736AunwUGmc
      4tFQ/DkCgYAUddTZ2VbO5FM8Oe/MFnqCLT215IBUAnDScCrdOYU0KCipZa/zntyA
      rhHekPxyHgkEj2TYMNQRzu3aIHz2m17YpHr/eouADIQUmZeKSUNMYacanR2CItGH
      2ggwt4VZkINfjoJqTd5XLc6VFTqeHU6F34EaKBjxShGrutn9GXxNVw==
      -----END RSA PRIVATE KEY-----
    # Jobs params
    jenkins_gerrit_url: ssh://admin@${_param:haproxy_gerrit_bind_host}:${_param:haproxy_gerrit_ssh_bind_port}

    # Gerrit
    gerrit_admin_email: ${_param:admin_email}
    gerrit_public_host: https://${_param:nginx_proxy_gerrit_server_site_host}:${_param:nginx_proxy_gerrit_server_site_port}
    gerrit_admin_public_key: ${_param:jenkins_admin_public_key}
    gerrit_admin_private_key: ${_param:jenkins_admin_private_key}
    gerrit_auth_type: LDAP
    gerrit_ldap_server: "ldap://${_param:cluster_vip_address}"
    gerrit_ldap_bind_user: "cn=admin,${_param:openldap_dn}"
    gerrit_ldap_bind_password: ${_param:openldap_admin_password}
    gerrit_ldap_account_base: ou=people,${_param:openldap_dn}
    gerrit_ldap_group_base: ou=groups,${_param:openldap_dn}
